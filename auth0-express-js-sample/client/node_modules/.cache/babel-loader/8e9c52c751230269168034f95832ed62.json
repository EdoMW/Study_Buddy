{"ast":null,"code":"import _regeneratorRuntime from\"/home/daniel/workspace/study_buddy/Study_Buddy/auth0-express-js-sample/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/daniel/workspace/study_buddy/Study_Buddy/auth0-express-js-sample/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/daniel/workspace/study_buddy/Study_Buddy/auth0-express-js-sample/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// src/views/external-api.js\nimport React,{useState}from\"react\";import{useAuth0}from\"@auth0/auth0-react\";var ExternalApi=()=>{var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var serverUrl=process.env.REACT_APP_SERVER_URL;var _useAuth=useAuth0(),getAccessTokenSilently=_useAuth.getAccessTokenSilently;var callApi=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,responseData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(serverUrl,\"/api/messages/public-message\"));case 3:response=_context.sent;_context.next=6;return response.json();case 6:responseData=_context.sent;setMessage(responseData.message);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);setMessage(_context.t0.message);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function callApi(){return _ref.apply(this,arguments);};}();var callSecureApi=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var token,response,responseData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return getAccessTokenSilently();case 3:token=_context2.sent;_context2.next=6;return fetch(\"\".concat(serverUrl,\"/api/messages/protected-message\"),{headers:{Authorization:\"Bearer \".concat(token)}});case 6:response=_context2.sent;_context2.next=9;return response.json();case 9:responseData=_context2.sent;setMessage(responseData.message);_context2.next=16;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](0);setMessage(_context2.t0.message);case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[0,13]]);}));return function callSecureApi(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"h1\",null,\"External API\"),/*#__PURE__*/React.createElement(\"p\",null,\"Use these buttons to call an external API. The protected API call has an access token in its authorization header. The API server will validate the access token using the Auth0 Audience value.\"),/*#__PURE__*/React.createElement(\"div\",{className:\"btn-group mt-5\",role:\"group\",\"aria-label\":\"External API Requests Examples\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-primary\",onClick:callApi},\"Get Public Message\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-primary\",onClick:callSecureApi},\"Get Protected Message\")),message&&/*#__PURE__*/React.createElement(\"div\",{className:\"mt-5\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"muted\"},\"Result\"),/*#__PURE__*/React.createElement(\"div\",{className:\"container-fluid\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"code\",{className:\"col-12 text-light bg-dark p-4\"},message)))));};export default ExternalApi;","map":{"version":3,"sources":["/home/daniel/workspace/study_buddy/Study_Buddy/auth0-express-js-sample/client/src/views/external-api.js"],"names":["React","useState","useAuth0","ExternalApi","message","setMessage","serverUrl","process","env","REACT_APP_SERVER_URL","getAccessTokenSilently","callApi","fetch","response","json","responseData","callSecureApi","token","headers","Authorization"],"mappings":"ykBAAA;AAEA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,QAAT,KAAyB,oBAAzB,CAEA,GAAMC,CAAAA,WAAW,CAAG,IAAM,eACMF,QAAQ,CAAC,EAAD,CADd,wCACjBG,OADiB,eACRC,UADQ,eAExB,GAAMC,CAAAA,SAAS,CAAGC,OAAO,CAACC,GAAR,CAAYC,oBAA9B,CAFwB,aAIWP,QAAQ,EAJnB,CAIhBQ,sBAJgB,UAIhBA,sBAJgB,CAMxB,GAAMC,CAAAA,OAAO,0FAAG,mMAEWC,CAAAA,KAAK,WAAIN,SAAJ,iCAFhB,QAENO,QAFM,qCAIeA,CAAAA,QAAQ,CAACC,IAAT,EAJf,QAINC,YAJM,eAMZV,UAAU,CAACU,YAAY,CAACX,OAAd,CAAV,CANY,iFAQZC,UAAU,CAAC,YAAMD,OAAP,CAAV,CARY,qEAAH,kBAAPO,CAAAA,OAAO,0CAAb,CAYA,GAAMK,CAAAA,aAAa,2FAAG,gNAEEN,CAAAA,sBAAsB,EAFxB,QAEZO,KAFY,uCAIKL,CAAAA,KAAK,WACvBN,SADuB,oCAE1B,CACEY,OAAO,CAAE,CACPC,aAAa,kBAAYF,KAAZ,CADN,CADX,CAF0B,CAJV,QAIZJ,QAJY,uCAaSA,CAAAA,QAAQ,CAACC,IAAT,EAbT,QAaZC,YAbY,gBAelBV,UAAU,CAACU,YAAY,CAACX,OAAd,CAAV,CAfkB,qFAiBlBC,UAAU,CAAC,aAAMD,OAAP,CAAV,CAjBkB,uEAAH,kBAAbY,CAAAA,aAAa,2CAAnB,CAqBA,mBACE,2BAAK,SAAS,CAAC,WAAf,eACE,6CADF,cAEE,gOAFF,cAOE,2BACE,SAAS,CAAC,gBADZ,CAEE,IAAI,CAAC,OAFP,CAGE,aAAW,gCAHb,eAKE,8BAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,iBAAhC,CAAkD,OAAO,CAAEL,OAA3D,uBALF,cAQE,8BACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,iBAFZ,CAGE,OAAO,CAAEK,aAHX,0BARF,CAPF,CAuBGZ,OAAO,eACN,2BAAK,SAAS,CAAC,MAAf,eACE,0BAAI,SAAS,CAAC,OAAd,WADF,cAEE,2BAAK,SAAS,CAAC,iBAAf,eACE,2BAAK,SAAS,CAAC,KAAf,eACE,4BAAM,SAAS,CAAC,+BAAhB,EAAiDA,OAAjD,CADF,CADF,CAFF,CAxBJ,CADF,CAoCD,CA3ED,CA6EA,cAAeD,CAAAA,WAAf","sourcesContent":["// src/views/external-api.js\n\nimport React, { useState } from \"react\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\n\nconst ExternalApi = () => {\n  const [message, setMessage] = useState(\"\");\n  const serverUrl = process.env.REACT_APP_SERVER_URL;\n\n  const { getAccessTokenSilently } = useAuth0();\n\n  const callApi = async () => {\n    try {\n      const response = await fetch(`${serverUrl}/api/messages/public-message`);\n\n      const responseData = await response.json();\n\n      setMessage(responseData.message);\n    } catch (error) {\n      setMessage(error.message);\n    }\n  };\n\n  const callSecureApi = async () => {\n    try {\n      const token = await getAccessTokenSilently();\n\n      const response = await fetch(\n        `${serverUrl}/api/messages/protected-message`,\n        {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        }\n      );\n\n      const responseData = await response.json();\n\n      setMessage(responseData.message);\n    } catch (error) {\n      setMessage(error.message);\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      <h1>External API</h1>\n      <p>\n        Use these buttons to call an external API. The protected API call has an\n        access token in its authorization header. The API server will validate\n        the access token using the Auth0 Audience value.\n      </p>\n      <div\n        className=\"btn-group mt-5\"\n        role=\"group\"\n        aria-label=\"External API Requests Examples\"\n      >\n        <button type=\"button\" className=\"btn btn-primary\" onClick={callApi}>\n          Get Public Message\n        </button>\n        <button\n          type=\"button\"\n          className=\"btn btn-primary\"\n          onClick={callSecureApi}\n        >\n          Get Protected Message\n        </button>\n      </div>\n      {message && (\n        <div className=\"mt-5\">\n          <h6 className=\"muted\">Result</h6>\n          <div className=\"container-fluid\">\n            <div className=\"row\">\n              <code className=\"col-12 text-light bg-dark p-4\">{message}</code>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ExternalApi;"]},"metadata":{},"sourceType":"module"}